@use '../core/mixins' as mixins;
/* ===== Admin Dashboard polish (additive) ===== */

:root {
  --dash-gap: 1rem;
  --dash-card-radius: 12px;
}

/* Admin header */
#admin-dash .dashboard-header-block {
  margin-block: clamp(1rem, 2.5vw, 2rem);
}

#admin-dash .dashboard-header-block h1 {
  margin: 0 0 .25rem;
  color: var(--text-heading);
}

#admin-dash .dashboard-header-block .subtitle,
#admin-dash .dashboard-header-block .dashboard-subtitle {
  margin: 0 0 1.25rem;
  color: var(--text-muted, var(--text-body));
}

/* KPI grid layout */
#kpi {
  display: grid;
  gap: 1rem;
  grid-template-columns: 1fr 1fr;
  /* mobile: 2-up */
  margin-block: clamp(1rem, 2vw, 1.5rem);
}

@media (min-width: 992px) {
  #kpi {
    grid-template-columns: repeat(4, minmax(0, 1fr));
  }

  /* desktop: 4-up */
}

/* Card base (keep your classes) */
#kpi .oh-quarter {
  border: 1px solid var(--border-light);
  border-radius: 12px;
  background: var(--card-bg-default);
  box-shadow: var(--card-shadow-light, none);
}

/* Variants using your existing utility classes */
#kpi .oh-quarter.cws-dark {
  background: var(--card-bg-dark-variant, var(--brand-primary));
  color: var(--text-on-brand-bg);
}

#kpi .oh-quarter.cws-mid {
  background: var(--background-2);
}

#kpi .oh-quarter.cws-light {
  background: var(--background-1);
}

/* Inner spacing + content alignment */
#kpi .oh-container {
  padding: 1rem;
}

#kpi .cws-db-row {
  display: flex;
  align-items: center;
  gap: .75rem;
}

#kpi .cws-db-row i {
  font-size: 1.25rem;
  color: var(--icon-default);
}

#kpi .dashboard-number strong {
  font-size: 1.5rem;
  color: inherit;
  /* inherits white on dark cards, heading color elsewhere */
}

#kpi h4 {
  margin: .5rem 0 0;
  color: var(--text-heading);
}

.dash-controls {
  display: grid;
  gap: .75rem;
  grid-template-columns: 1fr;
  align-items: center;
}

@media (min-width: 900px) {
  .dash-controls {
    grid-template-columns: 1fr auto;
  }
}

/* ===== Top band ========================================================= */
.dash-top {
  margin-block: clamp(1rem, 2.5vw, 2rem);

  .dash-top__row {
    display: grid;
    gap: 1rem;
  }

  .dash-top__title h1 {
    color: var(--text-heading);
    margin: 0 0 .25rem;
  }

  .dash-top__sub {
    color: var(--text-muted, var(--text-body));
    margin: 0;
  }

  /* Quick actions: mobile scroll, desktop wrap */
  .dash-quick {
    display: grid;
    grid-auto-flow: column;
    grid-auto-columns: max-content;
    gap: .5rem;
    overflow-x: auto;
    padding-bottom: .25rem;
    -webkit-overflow-scrolling: touch;
  }

  .qa {
    display: inline-flex;
    align-items: center;
    gap: .4rem;
    padding: .5rem .75rem;
    background: var(--table-head-bg, var(--card-bg-default));
    color: var(--text-body);
    border: 1px solid var(--border-light);
    border-radius: 10px;
    text-decoration: none;
    white-space: nowrap;
    transition: background-color .2s ease, border-color .2s ease, color .2s ease;
  }

  .qa:hover,
  .qa:focus {
    background: var(--background-2);
    border-color: var(--border-default);
  }
}

/* KPI strip */
.dash-kpis {
  margin-top: clamp(1rem, 2vw, 1.25rem);
  display: grid;
  gap: .75rem;
  grid-template-columns: repeat(2, minmax(0, 1fr));
}

.kpi-group {
  display: grid;
  gap: .5rem;
  margin: 16px;
}

.kpi-group__label {
  font-size: .85rem;
  color: var(--text-muted);
  padding-left: .25rem;
}

.kpi-row {
  display: grid;
  gap: 1rem;
  grid-template-columns: 1fr;
}

.kpi-row--1 {
  grid-template-columns: 1fr;
}

@media (min-width: 700px) {
  .kpi-row--3 {
    grid-template-columns: repeat(3, minmax(0, 1fr));
  }

  .kpi-row--4 {
    grid-template-columns: repeat(4, minmax(0, 1fr));
  }
}

.kpi {
  display: block;
  padding: 1rem;
  border: 1px solid var(--border-light);
  border-radius: 12px;
  background: var(--card-bg-default);
  box-shadow: var(--card-shadow-light, none);
  color: var(--text-body);
  text-decoration: none;
  min-height: 96px;
  transition: background-color .2s ease, box-shadow .2s ease, transform .06s ease;

  &:hover {
    background: var(--background-2);
  }

  &:focus-visible {
    outline: 2px solid var(--brand-secondary);
    outline-offset: 2px;
  }

  .cws-db-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: .75rem;
  }

  i {
    font-size: 1.1rem;
    color: var(--icon-default, var(--text-muted));
  }

  .dashboard-number {
    font-size: 1.4rem;
    font-weight: 700;
    line-height: 1;
  }

  .oh-row {
    display: flex;
    align-items: baseline;
    gap: .5rem;
    margin-top: .35rem;
  }
}

.kpi--finance {
  box-shadow: inset 0 0 0 2px rgba(103, 156, 213, .12);
}

.kpi--delivery {
  box-shadow: inset 0 0 0 2px rgba(120, 209, 71, .12);
}

/* green hint */
.kpi--time {
  box-shadow: inset 0 0 0 2px rgba(165, 134, 203, .12);
}

/* purple hint */
.kpi--growth {
  box-shadow: inset 0 0 0 2px rgba(234, 125, 81, .12);
}

/* orange hint */
.kpi__label {
  font-size: .9rem;
  color: var(--text-muted, var(--text-body));
}

.kpi__meta {
  margin-left: .5rem;
  color: var(--text-muted, var(--text-body));
}


.kpi__value {
  font-size: 1.25rem;
  font-weight: 600;
  color: var(--text-heading);
}

.kpi--ok {
  box-shadow: inset 0 0 0 2px rgba(120, 209, 71, .22);
}

.kpi--warn {
  box-shadow: inset 0 0 0 2px rgba(234, 125, 81, .22);
}


/* ≥ tablet: title + quick actions side-by-side; 4 KPIs */
@media (min-width: 768px) {
  .dash-top__row {
    grid-template-columns: 1fr auto;
    align-items: end;
  }

  .dash-quick {
    grid-auto-flow: row;
    grid-auto-columns: initial;
    grid-template-columns: repeat(5, max-content);
  }

  .dash-kpis {
    grid-template-columns: repeat(4, minmax(0, 1fr));
  }
}


.dashboard-row-4 {
  display: grid;
  gap: 1rem;
  grid-template-columns: 1fr;

  @include mixins.atTablet {
    grid-template-columns: repeat(4, minmax(0, 1fr));
  }
}

.range-tabs {
  display: flex;
  gap: .5rem;
  margin: .25rem 0 1rem
}

.range-tabs a {
  padding: .35rem .6rem;
  border: 1px solid var(--border-light);
  border-radius: 10px;
  background: var(--table-head-bg);
}

.range-tabs a.is-active {
  background: var(--brand-secondary);
  color: var(--text-on-brand-bg);
  border-color: transparent;
  box-shadow: 0 0 0 2px rgba(120, 209, 71, .25) inset;
}


/* Quick actions (your .dash-q-a + .underline-effect) */
.dash-q-a {
  display: grid;
  grid-auto-flow: column;
  grid-auto-columns: max-content;
  gap: .5rem;
  overflow-x: auto;
  padding: .25rem 0;
  -webkit-overflow-scrolling: touch;
}

.dash-q-a .underline-effect {
  display: inline-flex;
  align-items: center;
  gap: .4rem;
  padding: .5rem .75rem;
  background: var(--table-head-bg, var(--card-bg-default));
  color: var(--text-body);
  border: 1px solid var(--border-light);
  border-radius: 10px;
  text-decoration: none;
  white-space: nowrap;
  transition: background-color .2s ease, border-color .2s ease, color .2s ease;
}

.dash-q-a .underline-effect:hover,
.dash-q-a .underline-effect:focus {
  background: var(--background-2);
  border-color: var(--border-default);
}

/* ≥ tablet: let buttons wrap neatly */
@media (min-width: 768px) {
  .dash-q-a {
    grid-auto-flow: row;
    grid-template-columns: repeat(5, max-content);
    justify-content: start;
  }
}


.cws-dark {
  background: var(--brand-primary);
  color: var(--text-on-brand-bg);
}

.cws-mid {
  background: var(--brand-secondary);
  color: var(--text-on-brand-bg);
}

.cws-light {
  background: var(--background-2);
  color: var(--text-body);
}



/* Lower section: three columns container → responsive */
.container-3-col {
  display: flex;
  flex-direction: column;
  gap: 1rem;


  @include mixins.atLaptop {
    display: grid;
    grid-template-columns: 1fr 1fr;
    margin-top: 2rem;
  }

  @include mixins.atLaptop {
    grid-template-columns: 2fr 2fr 3fr;
  }

  .report-section {
    min-height: 200px;
    display: flex;
    flex-direction: column;
  }
}

/* Panel shell */
.report-section.card {
  border: 1px solid var(--border-light);
  border-radius: 12px;
  background: var(--card-bg-default);
  box-shadow: var(--card-shadow-light, none);
  padding: 1rem;
  width: 100%;
  margin-bottom: 1.5rem;
  min-height: 200px;

  h2 {
    background: var(--background-2);
    border-bottom: 1px solid var(--border-light);
    border-radius: 8px 8px 0 0;
    padding: .6rem .8rem;
    margin: 0 0 .5rem;
    font-size: 1rem;
    color: var(--text-heading);

    p {
      color: var(--text-body);
    }
  }

  /* Compact list styling */
  .simple-list {
    display: grid;
    gap: .5rem;
    list-style: none;
    padding: 0;
    margin: 0;

    li {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: .75rem;
      padding: .55rem .65rem;
      border: 1px solid var(--border-light);
      border-radius: 8px;
      background: var(--background-1);
    }

    li:hover {
      background: var(--table-row-hover-bg);
    }

    a {
      color: var(--link-color);
      font-weight: 500;

      &:hover {
        text-decoration: underline;
      }
    }

    .aging-bar {
      display: block;
      height: 6px;
      border-radius: 999px;
      background: var(--background-2);
      margin-top: .35rem;
      position: relative;
    }

    .aging-bar::before {
      content: "";
      position: absolute;
      inset: 0 auto 0 0;
      width: var(--p, 0%);
      background: linear-gradient(90deg, rgba(103, 156, 213, .35), rgba(120, 209, 71, .35));
      border-radius: inherit;
    }
  }

  /* Nice empty state */
  .report-section .empty,
  .report-section p:only-child {
    background: var(--background-1);
    border: 1px dashed var(--border-light);
    border-radius: 10px;
    padding: .8rem;
    color: var(--text-muted);
  }

  .attention-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: .6rem .75rem;
    border: 1px solid var(--border-light);
    border-radius: 10px;
    background: var(--background-1);
    text-decoration: none;
    color: var(--text-body);
  }

  .attention-row:hover {
    background: var(--background-2);
  }
}